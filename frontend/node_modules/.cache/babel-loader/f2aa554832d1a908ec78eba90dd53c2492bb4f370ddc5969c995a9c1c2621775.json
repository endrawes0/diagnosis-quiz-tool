{"ast":null,"code":"import _objectSpread from\"/home/endrawes/diagnosis_quiz_tool/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import styles from'../styles/QuizPlayer.module.css';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const MultiCaseMatcher=_ref=>{let{question,onAnswerSelect,selectedAnswer,showFeedback=false,isSubmitted=false}=_ref;const[diagnosisPositions,setDiagnosisPositions]=useState({});const[draggedDiagnosis,setDraggedDiagnosis]=useState(null);const{cases,diagnosis_options}=question;const handleDragStart=(e,diagnosis)=>{setDraggedDiagnosis(diagnosis);e.dataTransfer.effectAllowed='move';};const handleDragOver=e=>{e.preventDefault();e.dataTransfer.dropEffect='move';};const handleDrop=(e,caseId)=>{e.preventDefault();if(draggedDiagnosis&&!isSubmitted){setDiagnosisPositions(prev=>_objectSpread(_objectSpread({},prev),{},{[caseId]:draggedDiagnosis}));setDraggedDiagnosis(null);// Notify parent of the answer\nconst answer=_objectSpread(_objectSpread({},diagnosisPositions),{},{[caseId]:draggedDiagnosis});onAnswerSelect(answer);}};const handleDragEnd=()=>{setDraggedDiagnosis(null);};const getCaseDiagnosis=caseId=>{return diagnosisPositions[caseId]||null;};const getAvailableDiagnoses=()=>{const usedDiagnoses=Object.values(diagnosisPositions);return diagnosis_options.filter(diag=>!usedDiagnoses.includes(diag));};const renderCaseColumn=(caseData,index)=>{const assignedDiagnosis=getCaseDiagnosis(caseData.case_id);return/*#__PURE__*/_jsxs(\"div\",{className:styles.caseColumn,onDragOver:handleDragOver,onDrop:e=>handleDrop(e,caseData.case_id),children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.caseCard,children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Case \",index+1]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.caseDetails,children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Age:\"}),\" \",caseData.age]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Chief Complaint:\"}),\" \",caseData.chief_complaint]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"History:\"}),\" \",caseData.history]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Examination:\"}),\" \",caseData.examination]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.diagnosisSlot,children:assignedDiagnosis?/*#__PURE__*/_jsxs(\"div\",{className:styles.assignedDiagnosis,children:[/*#__PURE__*/_jsx(\"span\",{children:assignedDiagnosis.text}),!isSubmitted&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setDiagnosisPositions(prev=>{const newPositions=_objectSpread({},prev);delete newPositions[caseData.case_id];return newPositions;});},className:styles.removeButton,children:\"\\xD7\"})]}):/*#__PURE__*/_jsx(\"div\",{className:styles.emptySlot,children:\"Drop diagnosis here\"})})]},caseData.case_id);};return/*#__PURE__*/_jsxs(\"div\",{className:styles.multiCaseContainer,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.casesRow,children:cases.map((caseData,index)=>renderCaseColumn(caseData,index))}),/*#__PURE__*/_jsxs(\"div\",{className:styles.diagnosesTray,children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Available Diagnoses\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.diagnosesGrid,children:getAvailableDiagnoses().map(diagnosis=>/*#__PURE__*/_jsx(\"div\",{draggable:!isSubmitted,onDragStart:e=>handleDragStart(e,diagnosis),onDragEnd:handleDragEnd,className:\"\".concat(styles.diagnosisCard,\" \").concat(draggedDiagnosis&&draggedDiagnosis.id===diagnosis.id?styles.dragging:''),children:diagnosis.text},diagnosis.id))})]}),showFeedback&&/*#__PURE__*/_jsxs(\"div\",{className:styles.feedback,children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Results\"}),cases.map((caseData,index)=>{const assigned=getCaseDiagnosis(caseData.case_id);const correct=question.correct_mapping[caseData.case_id];const isCorrect=assigned&&assigned.text===correct;return/*#__PURE__*/_jsxs(\"div\",{className:styles.caseResult,children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"Case \",index+1,\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:isCorrect?styles.correct:styles.incorrect,children:assigned?assigned.text:'No diagnosis assigned'}),!isCorrect&&/*#__PURE__*/_jsxs(\"span\",{children:[\" (Correct: \",correct,\")\"]})]},caseData.case_id);})]})]});};export default MultiCaseMatcher;","map":{"version":3,"names":["React","useState","styles","jsxs","_jsxs","jsx","_jsx","MultiCaseMatcher","_ref","question","onAnswerSelect","selectedAnswer","showFeedback","isSubmitted","diagnosisPositions","setDiagnosisPositions","draggedDiagnosis","setDraggedDiagnosis","cases","diagnosis_options","handleDragStart","e","diagnosis","dataTransfer","effectAllowed","handleDragOver","preventDefault","dropEffect","handleDrop","caseId","prev","_objectSpread","answer","handleDragEnd","getCaseDiagnosis","getAvailableDiagnoses","usedDiagnoses","Object","values","filter","diag","includes","renderCaseColumn","caseData","index","assignedDiagnosis","case_id","className","caseColumn","onDragOver","onDrop","children","caseCard","caseDetails","age","chief_complaint","history","examination","diagnosisSlot","text","onClick","newPositions","removeButton","emptySlot","multiCaseContainer","casesRow","map","diagnosesTray","diagnosesGrid","draggable","onDragStart","onDragEnd","concat","diagnosisCard","id","dragging","feedback","assigned","correct","correct_mapping","isCorrect","caseResult","incorrect"],"sources":["/home/endrawes/diagnosis_quiz_tool/frontend/src/components/MultiCaseMatcher.js"],"sourcesContent":["import React, { useState } from 'react';\nimport styles from '../styles/QuizPlayer.module.css';\n\nconst MultiCaseMatcher = ({\n  question,\n  onAnswerSelect,\n  selectedAnswer,\n  showFeedback = false,\n  isSubmitted = false\n}) => {\n  const [diagnosisPositions, setDiagnosisPositions] = useState({});\n  const [draggedDiagnosis, setDraggedDiagnosis] = useState(null);\n\n  const { cases, diagnosis_options } = question;\n\n  const handleDragStart = (e, diagnosis) => {\n    setDraggedDiagnosis(diagnosis);\n    e.dataTransfer.effectAllowed = 'move';\n  };\n\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  const handleDrop = (e, caseId) => {\n    e.preventDefault();\n    if (draggedDiagnosis && !isSubmitted) {\n      setDiagnosisPositions(prev => ({\n        ...prev,\n        [caseId]: draggedDiagnosis\n      }));\n      setDraggedDiagnosis(null);\n\n      // Notify parent of the answer\n      const answer = { ...diagnosisPositions, [caseId]: draggedDiagnosis };\n      onAnswerSelect(answer);\n    }\n  };\n\n  const handleDragEnd = () => {\n    setDraggedDiagnosis(null);\n  };\n\n  const getCaseDiagnosis = (caseId) => {\n    return diagnosisPositions[caseId] || null;\n  };\n\n  const getAvailableDiagnoses = () => {\n    const usedDiagnoses = Object.values(diagnosisPositions);\n    return diagnosis_options.filter(diag => !usedDiagnoses.includes(diag));\n  };\n\n  const renderCaseColumn = (caseData, index) => {\n    const assignedDiagnosis = getCaseDiagnosis(caseData.case_id);\n\n    return (\n      <div\n        key={caseData.case_id}\n        className={styles.caseColumn}\n        onDragOver={handleDragOver}\n        onDrop={(e) => handleDrop(e, caseData.case_id)}\n      >\n        <div className={styles.caseCard}>\n          <h4>Case {index + 1}</h4>\n          <div className={styles.caseDetails}>\n            <p><strong>Age:</strong> {caseData.age}</p>\n            <p><strong>Chief Complaint:</strong> {caseData.chief_complaint}</p>\n            <p><strong>History:</strong> {caseData.history}</p>\n            <p><strong>Examination:</strong> {caseData.examination}</p>\n          </div>\n        </div>\n        <div className={styles.diagnosisSlot}>\n          {assignedDiagnosis ? (\n            <div className={styles.assignedDiagnosis}>\n              <span>{assignedDiagnosis.text}</span>\n              {!isSubmitted && (\n                <button\n                  onClick={() => {\n                    setDiagnosisPositions(prev => {\n                      const newPositions = { ...prev };\n                      delete newPositions[caseData.case_id];\n                      return newPositions;\n                    });\n                  }}\n                  className={styles.removeButton}\n                >\n                  Ã—\n                </button>\n              )}\n            </div>\n          ) : (\n            <div className={styles.emptySlot}>\n              Drop diagnosis here\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={styles.multiCaseContainer}>\n      <div className={styles.casesRow}>\n        {cases.map((caseData, index) => renderCaseColumn(caseData, index))}\n      </div>\n\n      <div className={styles.diagnosesTray}>\n        <h4>Available Diagnoses</h4>\n        <div className={styles.diagnosesGrid}>\n          {getAvailableDiagnoses().map(diagnosis => (\n            <div\n              key={diagnosis.id}\n              draggable={!isSubmitted}\n              onDragStart={(e) => handleDragStart(e, diagnosis)}\n              onDragEnd={handleDragEnd}\n              className={`${styles.diagnosisCard} ${draggedDiagnosis && draggedDiagnosis.id === diagnosis.id ? styles.dragging : ''}`}\n            >\n              {diagnosis.text}\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {showFeedback && (\n        <div className={styles.feedback}>\n          <h4>Results</h4>\n          {cases.map((caseData, index) => {\n            const assigned = getCaseDiagnosis(caseData.case_id);\n            const correct = question.correct_mapping[caseData.case_id];\n            const isCorrect = assigned && assigned.text === correct;\n\n            return (\n              <div key={caseData.case_id} className={styles.caseResult}>\n                <strong>Case {index + 1}:</strong>\n                <span className={isCorrect ? styles.correct : styles.incorrect}>\n                  {assigned ? assigned.text : 'No diagnosis assigned'}\n                </span>\n                {!isCorrect && <span> (Correct: {correct})</span>}\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MultiCaseMatcher;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}